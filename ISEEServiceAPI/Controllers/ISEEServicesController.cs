using ISEEService.BusinessLogic;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using ISEEService.DataContract;
using Microsoft.AspNetCore.Hosting;
using ITUtility;
using Microsoft.Extensions.Configuration;
using System.Security.Claims;
using Microsoft.IdentityModel.Tokens;
using System.IdentityModel.Tokens.Jwt;
using System.Text;
using Microsoft.AspNetCore.Authorization;
using ISEEServiceAPI.CustomPolicyProvider;
using Microsoft.Extensions.Options;
using DevExpress.Data.Filtering.Helpers;

namespace ISEEServiceAPI.Controllers
{
    [Authorize]
    [ApiController]
    [Route("api/v1/[controller]")]
    public class ISEEServicesController : ControllerBase
    {
        private readonly ServiceAction service = null;
        private readonly IConfiguration Configuration = null;
        private readonly IWebHostEnvironment _hostingEnvironment;
        private readonly string filedumy = @"/9j/4AAQSkZJRgABAAEAeAB4AAD//gAfTEVBRCBUZWNobm9sb2dpZXMgSW5jLiBWMS4wMQD/2wCEAAUFBQgFCAwHBwwMCQkJDA0MDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0BBQgICgcKDAcHDA0MCgwNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDf/EAaIAAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKCwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+foRAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/AABEIAfQCvAMBEQACEQEDEQH/2gAMAwEAAhEDEQA/APsugAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAo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AUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA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oAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgD//2Q==";
        private readonly string pathfile;

        // private readonly MailSettings mailService;
        public ISEEServicesController(IWebHostEnvironment hostingEnvironment, IConfiguration Configuration)
        {
            this._hostingEnvironment = hostingEnvironment;
            this.Configuration = Configuration;
            this.pathfile = $@"{_hostingEnvironment.ContentRootPath}\Files";
            MailSettings mailSettings = new MailSettings
            {
                DisplayName = Configuration["MailSettings:DisplayName"],
                Host = Configuration["MailSettings:Host"],
                Mail = Configuration["MailSettings:Mail"],
                Password = Configuration["MailSettings:Password"],
                Port = Convert.ToInt32(Configuration["MailSettings:Port"])
            };
            this.service = new ServiceAction(this.Configuration.GetConnectionString("ConnectionSQLServer"), mailSettings, Configuration["ConfigSetting:DBENV"]);
            //this.mailService = mailService;
        }
        [HttpGet("HealthCheck")]
        [AllowAnonymous]
        public async ValueTask<IActionResult> HealthCheck()
        {
            //await this.service.testimage();
            return Ok("Running...");
        }
        [HttpGet("CheckConnectDB")]
        public async ValueTask<IActionResult> CheckConnectDB()
        {
            await this.service.CheckConnectDB();
            return Ok();
        }

        #region " STATICDATA "

        [HttpGet("TBM_SUBSTATUS")]
        [AllowAnonymous]
        public async ValueTask<IActionResult> TBM_SUBSTATUS()
        {
            try
            {
                var result = await this.service.TBM_SUBSTATUSAsync();
                return Ok(result);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpGet("GET_PROVINCE")]
        //[SecurityLevel(2)]
        public async ValueTask<IActionResult> GET_PROVINCE()
        {
            List<tbm_province> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_PROVINCE();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpGet("GET_DISTRICT/{province_code}")]
        public async ValueTask<IActionResult> GET_DISTRICT(string province_code)
        {
            List<tbm_district> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_DISTRICT(province_code);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpGet("GET_SUB_DISTRICT/{district_code}")]
        public async ValueTask<IActionResult> GET_SUB_DISTRICT(string district_code)
        {
            List<tbm_sub_district> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_SUB_DISTRICT(district_code);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpGet("GET_EMPLOYEE_POSITION")]
        public async ValueTask<IActionResult> GET_EMPLOYEE_POSITION()
        {
            List<tbm_employee_position> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_EMPLOYEE_POSITIONAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpGet("GET_JOBTYPE")]
        public async ValueTask<IActionResult> GET_JOBTYPE()
        {
            List<tbm_jobtype> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_JOBTYPEAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpGet("GET_TBM_IMAGE_TYPE")]
        public async ValueTask<IActionResult> GET_TBM_IMAGE_TYPEAsync()
        {
            List<tbm_image_type> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_IMAGE_TYPEAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpGet("CHECKLIST")]
        public async ValueTask<IActionResult> CHECKLIST()
        {
            List<tbm_checklist_group> dataObjects = null;
            try
            {
                dataObjects = await this.service.CHECK_LIST();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpGet("GET_UNIT")]
        public async ValueTask<IActionResult> GET_TBM_UNITAsync()
        {
            List<tbm_unit> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_UNITAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }


        [HttpGet("GET_JOBDETAIL_LIST/{userid}")]

        public async ValueTask<IActionResult> GET_JOBDETAIL_LIST(string userid)
        {
            List<job_detail_list> dataObjects = null;
            try
            {
                if (string.IsNullOrWhiteSpace(userid)) return BadRequest("Require userid");
                userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                dataObjects = await this.service.GET_JOB_DETAIL_LISTAsync(userid);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("Job_Close")]

        public async ValueTask<IActionResult> Job_Close()
        {
            List<job_detail_list> dataObjects = null;
            try
            {
                string userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                dataObjects = await this.service.sp_get_tbm_job_data_close(userid);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_FILE/{ijob_id}/{seq}")]
        public async ValueTask<IActionResult> GET_FILE(string ijob_id, string seq)
        {
            try
            {
                if (string.IsNullOrEmpty(ijob_id)) return BadRequest("Require ijob_id");
                if (string.IsNullOrEmpty(seq)) return BadRequest("Require seq");
                var dataObject = await this.service.GET_PATHFILE(ijob_id, seq);
                if (dataObject is null) return NoContent();
                if (System.IO.File.Exists(dataObject.img_path))
                {
                    DataFile file = new DataFile(dataObject.img_path);
                    file.FileName = dataObject.img_name;
                    return Ok(file);
                }
                else
                {
                    DataFile file = new DataFile();
                    file.FileData = Convert.FromBase64String(filedumy);
                    file.ContentType = "image/jpg";
                    file.FileName = "dummy.jpg";
                    return Ok(file);
                }

            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        #endregion " STATICDATA "

        #region " GET "
        [HttpGet("CHECK_STOCK/{part_id}/{location_id}")]
        //[SecurityLevel(2)]
        public async ValueTask<IActionResult> CHECK_STOCK(string part_id, string location_id)
        {
            long? dataObjects = null;
            try
            {
                dataObjects = await this.service.CHECK_STOCK(part_id, location_id);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpPost("GET_TBM_CUSTOMER")]
        public async ValueTask<IActionResult> GET_TBM_CUSTOMERAsync(tbm_customer data)
        {
            List<tbm_customer> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_CUSTOMERAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("RPT_TBM_CUSTOMER")]
        public async ValueTask<IActionResult> RPT_TBM_CUSTOMERAsync(tbm_customer data)
        {
            //List<tbm_customer> dataObjects = null;
            try
            {
               var dataObjects = await this.service.RPT_TBM_CUSTOMERAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("GET_TBM_EMPLOYEE")]
        public async ValueTask<IActionResult> GET_TBM_EMPLOYEE(tbm_employee data)
        {
            List<tbm_employee> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_EMPLOYEEAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("RPT_TBM_EMPLOYEE")]
        public async ValueTask<IActionResult> RPT_TBM_EMPLOYEE(tbm_employee data)
        {
           // List<tbm_employee> dataObjects = null;
            try
            {
               var dataObjects = await this.service.RPT_TBM_EMPLOYEEAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("GET_TBM_VEHICLE")]
        public async ValueTask<IActionResult> GET_TBM_VEHICLEAsync(tbm_vehicle data)
        {
            List<tbm_vehicle> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_VEHICLEAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("RPT_TBM_VEHICLE")]
        public async ValueTask<IActionResult> RPT_TBM_VEHICLEAsync(tbm_vehicle data)
        {
           // List<tbm_vehicle> dataObjects = null;
            try
            {
              var  dataObjects = await this.service.RPT_TBM_VEHICLEAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("GET_TBM_SERVICES")]
        public async ValueTask<IActionResult> GET_TBM_SERVICESAsync(tbm_services data)
        {
            List<tbm_services> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_SERVICESAsync(data);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("GET_TBM_LOCATION_STORE")]
        public async ValueTask<IActionResult> GET_TBM_LOCATION_STOREAsync(tbm_location_store condition)
        {
            List<tbm_location_store> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBM_LOCATION_STOREAsync(condition);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("GET_TBM_SPAREPART")]

        public async ValueTask<IActionResult> GET_TBM_SPAREPARTAsync(tbm_sparepart condition)
        {
            List<tbm_sparepart> dataObjects = null;
            try
            {
                var user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                dataObjects = await this.service.GET_TBM_SPAREPARTAsync(condition, user_id);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("SPAREPART_ONHAND/{partid}/{jobid}")]

        public async ValueTask<IActionResult> SPAREPART_ONHAND(string partid, string jobid)
        {
            try
            {
                // var user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                if (jobid == "none")
                {
                    jobid = string.Empty;
                }
                var dataObjects = await this.service.sp_check_onhand(partid, jobid);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("SPARE_PART_DETAIL/{part_id}")]

        public async ValueTask<IActionResult> SPARE_PART_DETAIL(string part_id)
        {
            List<tbm_sparepart> dataObjects = null;
            try
            {
                var user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                dataObjects = await this.service.sp_tbm_sparepart_detail(part_id);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_TBM_BRAND")]
        public async ValueTask<IActionResult> GET_BRANDAsync()
        {
            List<tbm_brand> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_BRANDAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_CONTRACT_TYPE")]
        public async ValueTask<IActionResult> GET_CONTRACTTYPEAsync()
        {
            List<tbm_contract_type> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_CONTRACTTYPEAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_EMPLOYEE")]
        public async ValueTask<IActionResult> GET_EMPLOYEEAsync()
        {
            List<tbm_employee> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_EMPLOYEEAsync();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_TBT_ADJ_SPAREPART_DETAIL/{part_id}")]
        public async ValueTask<IActionResult> GET_TBT_ADJ_SPAREPART_DETAIL(string part_id)
        {
            List<tbt_adj_sparepart> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBT_ADJ_SPAREPART_DETAIL(part_id);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpGet("GET_TBT_ADJ_SPAREPART/{adj_type}")]
        public async ValueTask<IActionResult> GET_TBT_ADJ_SPAREPART(string adj_type)
        {
            List<tbt_adj_sparepart> dataObjects = null;
            try
            {
                dataObjects = await this.service.GET_TBT_ADJ_SPAREPART(adj_type);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        #endregion " GET "

        #region " MANAGE JOBE "
        [HttpPost("CREATEJOB")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> INSERT_TBT_JOB_HEADER(create_job data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.type_job)) throw new Exception(" Required type_job");
                if (string.IsNullOrEmpty(data.customer_id)) throw new Exception(" Required customer_id");
                if (string.IsNullOrEmpty(data.email_customer)) throw new Exception(" Required email_customer");
                if (string.IsNullOrEmpty(data.owner_id)) throw new Exception(" Required owner_id");
                if (string.IsNullOrEmpty(data.user_id)) throw new Exception(" Required user_id");
                data.user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBT_JOB_HEADERAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("CLOSEJOB")]
        public async ValueTask<IActionResult> CLOSEJOB([FromBody] close_job data)
        {
            //string pathfile = $@"{_hostingEnvironment.ContentRootPath}\Files";
            List<tbt_job_image> job_image = new List<tbt_job_image>();
            try
            {
                data.userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                if (data.job_status == "C" && await service.CheckPermissionAdmin(data.userid))
                {
                    var job = await service.GET_TBT_JOB(data.job_id);
                    if (job is not null && (job.job_status == "D" || job.job_status == "F") && data.flg_close == "N")
                    {
                        return Ok("ยืนยัน Close Job");
                    }
                    else
                    if (job is not null && job.job_status == "C" && data.flg_close == "N")
                    {
                        return Ok("ยืนยัน Close Job อีกครั้ง");
                    }
                    else if (job is not null && job.job_status == "C" && data.flg_close == "Y")
                    {
                        await SendEmailRpt(data);
                        await this.service.sp_update_cut_stock_job(data.job_id);
                        return Ok();
                    }
                }
                else if (data.job_status == "C" && !await service.CheckPermissionAdmin(data.userid))
                {
                    return BadRequest("No Permission");
                }
                else
                if (data.job_status == "F" && data.flg_close == "N")
                {
                    return Ok("ยืนยัน Close Job");
                }

                if (data.job_images is not null && data.job_images.Count > 0)
                {
                    if (!System.IO.Directory.Exists(pathfile))
                    {
                        System.IO.Directory.CreateDirectory(pathfile);
                    }
                    foreach (var item in data.job_images)
                    {
                        var filebyte = Convert.FromBase64String(item.FileData);
                        if (filebyte.Length > 5000)
                        {
                            var image_id = await this.service.GET_IMAGE_ID();
                            var img_path = await manageimage(item, pathfile, image_id);
                            job_image.Add(new tbt_job_image
                            {
                                ijob_id = data.job_id,
                                img_path = img_path,
                                image_type = item.image_type,
                                img_name = item.FileName
                            });
                        }

                    }
                }
                await this.service.Close_jobAsync(data, job_image);
                if (data.job_status == "C" && data.flg_close == "Y")
                {
                    await SendEmailRpt(data);
                    await this.service.sp_update_cut_stock_job(data.job_id);
                }
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        private async ValueTask SendEmailRpt(close_job data)
        {

            //กรณีส่งซ้ำไปดึงไฟล์มาส่งแทน
            string filename = "job.pdf";
            string image_type = "rpt";

            string userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
            var rpt = await service.CHECK_RESEND_EMAIL(data.job_id);
            bool isRPT = true;
            var jbdt = await service.GET_JOB_DETAIL(data.job_id);
            if (rpt is not null)
            {
                if (System.IO.File.Exists(rpt.img_path))
                {
                    DataFile filerpt = new DataFile(rpt.img_path);                   
                    await this.service.sendemail(filerpt, jbdt.email_customer, data.job_id);
                    tbt_email_history hemail = new tbt_email_history
                    {
                        email_address = jbdt.email_customer,
                        job_id = jbdt.job_id,
                        customer_id = jbdt.customer_id,
                        license_no = jbdt.license_no,
                        send_by = jbdt.userid,
                        email_code = "NT",

                    };
                    await this.service.INSERT_TBT_EMAIL_HISTORYAsync(hemail);
                    isRPT = false;
                }
            }
            if (isRPT)
            {
                job_file sign = null;
                if (data.job_images is not null)
                {
                    var fileallsign = data.job_images.Where(a => a.image_type.Equals("sig"))?.ToList();
                    if (fileallsign is not null)
                    {
                        foreach (var item in fileallsign)
                        {
                            var sig = Convert.FromBase64String(item.FileData);
                            if (sig.Length > 5000)
                            {
                                sign = new job_file
                                {
                                    FileData = item.FileData,
                                    ContentType = item.ContentType,
                                    FileName = item.FileName,
                                    image_type = item.image_type
                                };
                                var _image_id = await this.service.GET_IMAGE_ID();
                                var ipath = await manageimage(sign, pathfile, _image_id);
                                tbt_job_image job_image = new tbt_job_image
                                {
                                    ijob_id = data.job_id,
                                    image_type = item.image_type,
                                    img_name = item.FileName,
                                    img_path = ipath
                                };
                                await service.INSERT_TBT_JOB_IMAGE(job_image, userid, data.job_id);
                                break;
                            }
                        }
                    }

                }
                var file = await service.GET_REPORT_CLOSE_JOB(data.job_id, sign);
                var image_id = await this.service.GET_IMAGE_ID();
                job_file jbfile = new job_file
                {
                    FileData = Convert.ToBase64String(file.FileData),
                    FileName = filename,
                    ContentType = "application/pdf",
                    image_type = image_type
                };
                var img_path = await manageimage(jbfile, pathfile, image_id);
                tbt_job_image tbt_job_image = new tbt_job_image
                {
                    ijob_id = data.job_id,
                    image_type = image_type,
                    img_name = filename,
                    img_path = img_path
                };
                await service.TMN_TBT_JOB_IMAGE(data.job_id, image_type);
                await service.INSERT_TBT_JOB_IMAGE(tbt_job_image, userid, data.job_id);
                await this.service.sendemail(file, jbdt.email_customer, data.job_id);
                tbt_email_history hemail = new tbt_email_history
                {
                    email_address = data.email_customer,
                    job_id = data.job_id,
                    customer_id = data.customer_id,
                    license_no = data.license_no,
                    send_by = data.userid,
                    email_code = "NT",

                };
                await this.service.INSERT_TBT_EMAIL_HISTORYAsync(hemail);
            }
        }

        [HttpPost("GET_CUSTOMER_BY_JOB")]
        public async ValueTask<IActionResult> GET_CUSTOMER(string license_no)
        {
            List<Customer> dataObjects = null;
            try
            {
                if (string.IsNullOrWhiteSpace(license_no)) return BadRequest("Require license_no");
                dataObjects = await this.service.GET_CUSTOMER(license_no);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("GET_JOBREF")]
        public async ValueTask<IActionResult> GET_JOBREFAsync(job_ref job)
        {
            List<tbt_job_header> dataObjects = null;
            try
            {
                var userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                if (string.IsNullOrWhiteSpace(job.customer_id)) return BadRequest("Require customer_id");
                if (string.IsNullOrWhiteSpace(job.license_no)) return BadRequest("Require license_no");
                //tbt_job_header job
                dataObjects = await this.service.GET_JOBREFAsync(job);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpPost("GET_JOBDETAIL")]

        public async ValueTask<IActionResult> GET_JOB_DETAIL(string job_id)
        {
            close_job dataObjects = null;
            try
            {
                var userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                if (string.IsNullOrWhiteSpace(job_id)) return BadRequest("Require job_id");
                dataObjects = await this.service.GET_JOB_DETAIL(job_id);
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        #endregion " MANAGE JOBE "

        #region " INESERT && UPDATE "
        [HttpPost("INSERT_TBM_CUSTOMER")]
        // [SecurityLevel(3)]
        public async ValueTask<IActionResult> INSERT_TBM_CUSTOMER(tbm_customer data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.id_card)) throw new Exception(" Required id_card");
                if (string.IsNullOrEmpty(data.cust_type)) throw new Exception(" Required cust_type");
                if (string.IsNullOrEmpty(data.fname)) throw new Exception(" Required fname");
                if (string.IsNullOrEmpty(data.lname)) throw new Exception(" Required lname");
                if (string.IsNullOrEmpty(data.province_code)) throw new Exception(" Required province_code");
                if (string.IsNullOrEmpty(data.sub_district_no)) throw new Exception(" Required sub_district_no");
                if (string.IsNullOrEmpty(data.district_code)) throw new Exception(" Required district_code");
                if (string.IsNullOrEmpty(data.zip_code)) throw new Exception(" Required zip_code");
                if (string.IsNullOrEmpty(data.Email)) throw new Exception(" Required Email");

                await this.service.INSERT_TBM_CUSTOMERAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("INSERT_TBM_EMPLOYEE")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> INSERT_TBM_EMPLOYEE(employee data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.user_name)) throw new Exception(" Required user_name");
                if (string.IsNullOrEmpty(data.password)) throw new Exception(" Required password");
                if (string.IsNullOrEmpty(data.fullname)) throw new Exception(" Required fullname");
                if (string.IsNullOrEmpty(data.lastname)) throw new Exception(" Required lastname");
                if (string.IsNullOrEmpty(data.create_by)) throw new Exception(" Required create_by");
                if (string.IsNullOrEmpty(data.idcard)) throw new Exception(" Required idcard");
                data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBM_EMPLOYEEAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpPost("INSERT_TBM_VEHICLE")]
        public async ValueTask<IActionResult> INSERT_TBM_VEHICLE(tbm_vehicle data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.license_no)) throw new Exception(" Required license_no");
                if (string.IsNullOrEmpty(data.service_no)) throw new Exception(" Required service_no");
                if (string.IsNullOrEmpty(data.contract_no)) throw new Exception(" Required contract_no");
                if (string.IsNullOrEmpty(data.customer_id)) throw new Exception(" Required customer_id");
                //data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBM_VEHICLEAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("INSERT_TBM_SERVICES")]
        public async ValueTask<IActionResult> INSERT_TBM_SERVICES(tbm_services data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.jobcode)) throw new Exception(" Required jobcode");
                if (string.IsNullOrEmpty(data.services_name)) throw new Exception(" Required services_name");
                data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBM_SERVICESAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpPost("INSERT_TBM_LOCATION_STORE")]
        public async ValueTask<IActionResult> INSERT_TBM_LOCATION_STORE(tbm_location_store data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.location_name)) throw new Exception(" Required location_name");
                //if (string.IsNullOrEmpty(data.owner_id)) throw new Exception(" Required owner_id");
                data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBM_LOCATION_STOREAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("INSERT_TBM_SPAREPART")]
        public async ValueTask<IActionResult> INSERT_TBM_SPAREPARTAsync(tbm_sparepart data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.part_no)) throw new Exception(" Required part_no");
                if (string.IsNullOrEmpty(data.part_name)) throw new Exception(" Required part_name");
                if (string.IsNullOrEmpty(data.part_desc)) throw new Exception(" Required part_desc");
                if (string.IsNullOrEmpty(data.part_type)) throw new Exception(" Required part_type");
                if (string.IsNullOrEmpty(data.location_id)) throw new Exception(" Required location_id");
                data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBM_SPAREPARTAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("INSERT_TBT_ADJ_SPAREPART")]
        public async ValueTask<IActionResult> INSERT_TBT_ADJ_SPAREPARTAsync(tbt_adj_sparepart data)
        {
            try
            {
                if (string.IsNullOrEmpty(data.part_no)) throw new Exception(" Required part_no");
                if (string.IsNullOrEmpty(data.part_id)) throw new Exception(" Required part_id");
                if (string.IsNullOrEmpty(data.adj_part_value)) throw new Exception(" Required adj_part_value");
                data.create_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await this.service.INSERT_TBT_ADJ_SPAREPARTAsync(data);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("sp_update_start_job")]
        public async ValueTask<IActionResult> sp_update_start_job(close_job data)
        {
            try
            {
                var user_id = User.Claims.Where(a => a.Type == "id")?.Select(a => a.Value)?.FirstOrDefault();
                await this.service.sp_update_start_job(data.job_id, user_id);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("sp_update_receive_job")]
        public async ValueTask<IActionResult> sp_update_receive_job(close_job data)
        {
            try
            {
                var user_id =   User.Claims.Where(a => a.Type == "id")?.Select(a => a.Value)?.FirstOrDefault();
                await this.service.sp_update_receive_job(data.job_id, user_id);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("sp_update_travel_job")]
        public async ValueTask<IActionResult> sp_update_travel_job(close_job data)
        {
            try
            {
                var user_id = User.Claims.Where(a => a.Type == "id")?.Select(a => a.Value)?.FirstOrDefault();
                await this.service.sp_update_travel_job(data.job_id, user_id);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        #endregion " INESERT && UPDATE "

        #region " TERMINATE "

        [HttpPost("TERMINATE_TBM_CUSTOMER")]
        // [SecurityLevel(3)]
        public async ValueTask<IActionResult> TERMINATE_TBM_CUSTOMERAsync(model_terminate data)
        {
            try
            {
                if (data is not null)
                {
                    customer_terminate cus = new customer_terminate
                    {
                        user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault(),
                        customer_id = new List<string>()
                    };
                    foreach (var item in data.data)
                    {
                        cus.customer_id.Add(item.id);
                    }

                    await this.service.TERMINATE_TBM_CUSTOMERAsync(cus);
                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("TERMINATE_TBM_EMPLOYEE")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> TERMINATE_TBM_EMPLOYEEAsync(model_terminate data)
        {
            try
            {
                if (data is not null)
                {
                    employee_terminate em = new employee_terminate
                    {
                        terminate_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault(),
                        user_id = new List<string>()
                    };
                    foreach (var item in data.data)
                    {
                        em.user_id.Add(item.id);
                    }
                    await this.service.TERMINATE_TBM_EMPLOYEEAsync(em);
                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("TERMINATE_TBM_LOCATION_STORE")]
        // [SecurityLevel(3)]
        public async ValueTask<IActionResult> TERMINATE_TBM_LOCATION_STOREAsync(model_terminate data)
        {
            try
            {
                if (data is not null)
                {
                    location_store_terminate loc = new location_store_terminate
                    {
                        user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault(),
                        location_id = new List<string>()
                    };
                    foreach (var item in data.data)
                    {
                        loc.location_id.Add(item.id);
                    }
                    await this.service.TERMINATE_TBM_LOCATION_STOREAsync(loc);

                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("TERMINATE_TBM_SERVICES")]
        public async ValueTask<IActionResult> TERMINATE_TBM_SERVICESAsync(model_terminate data)
        {
            try
            {
                if (data is not null)
                {
                    service_terminate ser = new service_terminate
                    {
                        user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault(),
                        services_no = new List<string>()
                    };
                    foreach (var item in data.data)
                    {
                        ser.services_no.Add(item.id);
                    }
                    await this.service.TERMINATE_TBM_SERVICESAsync(ser);
                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("TERMINATE_TBM_SPAREPART")]
        public async ValueTask<IActionResult> TERMINATE_TBM_SPAREPARTAsync(model_terminate data)
        {
            try
            {
                if (data is not null)
                {
                    sparepart_terminate spar = new sparepart_terminate
                    {
                        user_id = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault(),
                        part_detail = new List<sparepart_id>()
                    };
                    foreach (var item in data.data)
                    {
                        spar.part_detail.Add(new sparepart_id { part_id = Convert.ToInt32(item.id), cancel_reason = item.msg });
                    }
                    await this.service.TERMINATE_TBM_SPAREPARTAsync(spar);
                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("TERMINATE_TBT_ADJ_SPAREPART")]
        public async ValueTask<IActionResult> TERMINATE_TBT_ADJ_SPAREPARTAsync(tbt_adj_sparepart data)
        {
            try
            {
                if (data is not null)
                {
                    data.cancel_by = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                    await this.service.TERMINATE_TBT_ADJ_SPAREPARTAsync(data);
                }

                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("TERMINATE_TBT_JOB_IMAGE")]
        public async ValueTask<IActionResult> TERMINATE_TBT_JOB_IMAGEAsync(string ijob_id, string seq)
        {
            try
            {
                if (string.IsNullOrWhiteSpace(ijob_id)) return BadRequest("Require ijob_id");
                if (string.IsNullOrWhiteSpace(seq)) return BadRequest("Require seq");
                await this.service.TERMINATE_TBT_JOB_IMAGE(ijob_id, seq);
                return Ok();
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        #endregion " TERMINATE "

        [AllowAnonymous]
        [HttpPost("Login")]
        public async ValueTask<IActionResult> Login(UserLogin user)
        {
            employee_info employee_Info = null;
            try
            {
                var isNotValid = string.IsNullOrWhiteSpace(user.UserName) || string.IsNullOrWhiteSpace(user.Password);
                if (isNotValid)
                {
                    return NotFound("ไม่พบข้อมูลผู้ใช้งาน");
                }
                employee_Info = await this.service.UserLogin(user);
                if (employee_Info is null)
                {
                    return BadRequest("UserName or Password invalid ");
                }
                else
                {
                    var token = await BuildToken(employee_Info);
                    var menu = await this.service.GET_MENU(employee_Info.user_id);
                    employee_Info.token = token;
                    employee_Info.menu = new List<tbm_menu>();
                    employee_Info.menu = menu;
                    return Ok(employee_Info);
                }
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("UserInfo")]
        public async ValueTask<IActionResult> UserInfo()
        {
            employee_info employee_Info = null;
            try
            {
                var username = User.Claims.Where(a => a.Type == "username").Select(a => a.Value).FirstOrDefault();
                if (username is null)
                {
                    return NotFound("ไม่พบข้อมูลผู้ใช้งาน");
                }

                employee_Info = await this.service.UserInfo(new UserLogin { UserName = username });
                if (employee_Info is null)
                {
                    return BadRequest("UserName invalid ");
                }
                else
                {
                    var token = await BuildToken(employee_Info);
                    var menu = await this.service.GET_MENU(employee_Info.user_id);
                    employee_Info.token = token;
                    employee_Info.menu = new List<tbm_menu>();
                    employee_Info.menu = menu;
                    return Ok(employee_Info);
                }
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        private async ValueTask<string> BuildToken(employee_info employee)
        {
            // key is case-sensitive
            var claims = new[] {
                new Claim(JwtRegisteredClaimNames.Sub, Configuration["Jwt:Subject"]),
                new Claim(DynamicPilicies.SecurityLevel ,employee.security_level),
                new Claim("id", employee.user_id),
                new Claim("username", employee.user_name),
                new Claim("position", employee.position),
                new Claim("position_description", employee.position_description),
            //ใช้ role เพื่อลดการโหลดดาต้าเบส
                new Claim(ClaimTypes.Role, employee.position)
            };
            var expires = DateTime.Now.AddDays(Convert.ToDouble(Configuration["Jwt:ExpireDay"]));
            //แก้วันที่ได้
            var key = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(Configuration["Jwt:Key"]));
            var creds = new SigningCredentials(key, SecurityAlgorithms.HmacSha256);

            var token = new JwtSecurityToken(
                issuer: Configuration["Jwt:Issuer"],
                audience: Configuration["Jwt:Audience"],
                claims: claims,
                expires: expires,
                signingCredentials: creds
            );

            return new JwtSecurityTokenHandler().WriteToken(token);
        }
        private async ValueTask<string> manageimage(job_file job_File, string path, long? image_id)
        {
            string typefile = job_File.FileName.Split('.').LastOrDefault() != null ? $".{job_File.FileName.Split('.').LastOrDefault()}" : "";
            string fullpath = $@"{path}\{DateTime.Now.Year}\{DateTime.Now.Month}\{DateTime.Now.Day}";
            string filename = $"{image_id}{typefile}";
            if (!System.IO.Directory.Exists(fullpath))
            {
                System.IO.Directory.CreateDirectory(fullpath);
            }
            string img_path = $@"{fullpath}\{filename}";
            await System.IO.File.WriteAllBytesAsync(img_path, Convert.FromBase64String(job_File.FileData));
            return img_path;
        }

        #region " REPORT "
        [AllowAnonymous]
        [HttpGet("GET_REPORT_CLOSE_JOB/{jobid}")]
        public async ValueTask<IActionResult> GET_REPORT_CLOSE_JOB(string jobid)
        {
            await SendEmailRpt(new close_job { job_id = jobid });
            return Ok();
        }
        [HttpPost("GET_Summary_job_list")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> GET_Summary_job_list(summary_job condition)
        {
            summary_job_list_condition dataObjects = null;
            try
            {
                if (condition is not null)
                {
                    dataObjects = new summary_job_list_condition
                    {
                        close_dt_from = condition.close_dt_from,
                        close_dt_to = condition.close_dt_to,
                        customer_name = condition.customer_name,
                        fix_date_from = condition.fix_date_from,
                        fix_date_to = condition.fix_date_to,
                        job_date_from = condition.job_date_from,
                        job_date_to = condition.job_date_to,
                        license_no = condition.license_no,
                        report_type = condition.report_type,
                        Teachnicial = condition.Teachnicial,
                        type_job = condition.type_job,
                        user_id = condition.user_id,
                        user_print = condition.user_print
                    };
                }
                dataObjects = await this.service.GET_Summary_job_list(dataObjects);
                if (dataObjects.report_type.ToUpper() == "SEARCH")
                {
                    return Ok(dataObjects);
                }
                else if (dataObjects.report_type.ToUpper() == "PDF")
                {
                    var pdf = await this.service.GET_REPORT_Summary_job_list(dataObjects);
                    return Ok(pdf);

                }
                else
                {
                    var xlsx = await this.service.GET_REPORT_Summary_job_list(dataObjects);
                    return Ok(xlsx);
                }

            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("GET_Summary_stock_list")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> GET_Summary_stock_list(summary_stock condition)
        {
            summary_stock_list_condition dataObjects = null;
            // List<summary_stock_list> dataObjects = null;
            try
            {
                //User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault()
                if (condition is not null)
                {
                    dataObjects = new summary_stock_list_condition
                    {
                        locationid = condition.locationid,
                        PartId = condition.PartId,
                        Partno = condition.Partno,
                        Part_create_from = condition.Part_create_from,
                        Part_create_to = condition.Part_create_to,
                        report_type = condition.report_type,
                        UserName = condition.UserName

                    };
                }

                dataObjects = await this.service.GET_Summary_stock_list(dataObjects);
                if (dataObjects.report_type.ToUpper() == "SEARCH")
                {
                    return Ok(dataObjects);
                }
                else if (dataObjects.report_type.ToUpper() == "PDF")
                {
                    var pdf = await this.service.GET_REPORT_Summary_stock_list(dataObjects);
                    return Ok(pdf);

                }
                else
                {
                    var xlsx = await this.service.GET_REPORT_Summary_stock_list(dataObjects);
                    return Ok(xlsx);
                }
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        [HttpPost("sp_getReportDownTime")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> sp_getReportDownTime(summary_job condition)
        {
            summary_job_list_condition dataObjects = null;
            try
            {
                if (condition is not null)
                {
                    dataObjects = new summary_job_list_condition
                    {
                        close_dt_from = condition.close_dt_from,
                        close_dt_to = condition.close_dt_to,
                        customer_name = condition.customer_name,
                        fix_date_from = condition.fix_date_from,
                        fix_date_to = condition.fix_date_to,
                        job_date_from = condition.job_date_from,
                        job_date_to = condition.job_date_to,
                        license_no = condition.license_no,
                        report_type = condition.report_type,
                        Teachnicial = condition.Teachnicial,
                        type_job = condition.type_job,
                        user_id = condition.user_id,
                        user_print = condition.user_print
                    };
                }
                var excel = await this.service.sp_getReportDownTime(dataObjects);
                return Ok(excel);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("sp_getReportProductive_time")]
        public async ValueTask<IActionResult> sp_getReportProductive_time()
        {         
            try
            {             
                var excel = await this.service.sp_getReportProductive_time();
                return Ok(excel);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }

        [HttpPost("sp_getReportRunningCost")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> sp_getReportRunningCost(summary_job condition)
        {
            summary_job_list_condition dataObjects = null;
            try
            {
                if (condition is not null)
                {
                    dataObjects = new summary_job_list_condition
                    {
                        close_dt_from = condition.close_dt_from,
                        close_dt_to = condition.close_dt_to,
                        customer_name = condition.customer_name,
                        fix_date_from = condition.fix_date_from,
                        fix_date_to = condition.fix_date_to,
                        job_date_from = condition.job_date_from,
                        job_date_to = condition.job_date_to,
                        license_no = condition.license_no,
                        report_type = condition.report_type,
                        Teachnicial = condition.Teachnicial,
                        type_job = condition.type_job,
                        user_id = condition.user_id,
                        user_print = condition.user_print
                    };
                }
                var excel = await this.service.sp_getReportRunningCost(dataObjects);
                return Ok(excel);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }

        }
        [HttpPost("sp_get_movement_sparepart")]
        //[SecurityLevel(3)]
        public async ValueTask<IActionResult> sp_get_movement_sparepart(summary_stock condition)
        {
            summary_stock_list_condition dataObjects = null;
            // List<summary_stock_list> dataObjects = null;
            try
            {
                //User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault()
                if (condition is not null)
                {
                    dataObjects = new summary_stock_list_condition
                    {
                        locationid = condition.locationid,
                        PartId = condition.PartId,
                        Partno = condition.Partno,
                        Part_create_from = condition.Part_create_from,
                        Part_create_to = condition.Part_create_to,
                        report_type = condition.report_type,
                        UserName = condition.UserName

                    };
                }

                var result = await this.service.sp_get_movement_sparepart(dataObjects);
                //var xlsx = await this.service.GET_REPORT_Summary_stock_list(dataObjects);
                return Ok(result);

            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpPost("sp_getReportPPM")]
        public async ValueTask<IActionResult> sp_getReportPPM()
        {
            List<ReportPPM> dataObjects = null;
            try
            {
                dataObjects = await this.service.sp_getReportPPM();
                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }

        [HttpGet("reportPMP/{rpttype}")]
        public async ValueTask<IActionResult> sp_getReportPPM(string rpttype)
        {

            try
            {
                var dataObjects = await this.service.sp_getReportPPMEXPORT(rpttype);

                return Ok(dataObjects);
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        #endregion " REPORT "

        #region " EMAIL "
        [HttpPost("SendEmail")]
        public async ValueTask<IActionResult> SendEmail(email_service condition)
        {
            employee_info employee_Info = null;
            try
            {
                var username = User.Claims.Where(a => a.Type == "username").Select(a => a.Value).FirstOrDefault();
                if (username is null)
                {
                    return NotFound("ไม่พบข้อมูลผู้ใช้งาน");
                }
                condition.userid = username;
                await service.SendEmail(condition);
                return Ok();
               
            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
        #endregion " EMAIL "
        [HttpPost("sp_update_cut_stock_job")]
        public async ValueTask<IActionResult> sp_update_cut_stock_job()
        {
            try
            {
                var userid = User.Claims.Where(a => a.Type == "id").Select(a => a.Value).FirstOrDefault();
                await service.sp_update_cut_stock_job(userid);
                return Ok();

            }
            catch (Exception ex)
            {
                return BadRequest(ex.Message);
            }
        }
    }
}
